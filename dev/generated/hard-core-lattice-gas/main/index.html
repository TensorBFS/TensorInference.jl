<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Hard-core Lattice Gas · TensorInference.jl</title><script data-outdated-warner src="../../../assets/warner.js"></script><link rel="canonical" href="https://TensorBFS.github.io/TensorInference.jl/generated/hard-core-lattice-gas/main/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.svg" alt="TensorInference.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">TensorInference.jl</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Background</span><ul><li><a class="tocitem" href="../../../probabilisticinference/">Probabilistic Inference</a></li><li><a class="tocitem" href="../../../tensornetwork/">Tensor Networks</a></li><li><a class="tocitem" href="../../../uai-file-formats/">UAI file formats</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../../examples-overview/">Overview</a></li><li><a class="tocitem" href="../../asia-network/main/">Asia Network</a></li><li class="is-active"><a class="tocitem" href>Hard-core Lattice Gas</a><ul class="internal"><li><a class="tocitem" href="#Hard-core-lattice-gas-problem"><span>Hard-core lattice gas problem</span></a></li><li><a class="tocitem" href="#Probabilistic-modeling-correlation-functions"><span>Probabilistic modeling correlation functions</span></a></li><li><a class="tocitem" href="#The-most-likely-configuration"><span>The most likely configuration</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../../performance/">Performance tips</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../../../api/public/">Public</a></li><li><a class="tocitem" href="../../../api/internal/">Internal</a></li></ul></li><li><a class="tocitem" href="../../../contributing/">Contributing</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Hard-core Lattice Gas</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Hard-core Lattice Gas</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/TensorBFS/TensorInference.jl/blob/main/docs/src/generated/hard-core-lattice-gas/main.jl#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="The-hard-core-lattice-gas"><a class="docs-heading-anchor" href="#The-hard-core-lattice-gas">The hard core lattice gas</a><a id="The-hard-core-lattice-gas-1"></a><a class="docs-heading-anchor-permalink" href="#The-hard-core-lattice-gas" title="Permalink"></a></h1><h2 id="Hard-core-lattice-gas-problem"><a class="docs-heading-anchor" href="#Hard-core-lattice-gas-problem">Hard-core lattice gas problem</a><a id="Hard-core-lattice-gas-problem-1"></a><a class="docs-heading-anchor-permalink" href="#Hard-core-lattice-gas-problem" title="Permalink"></a></h2><p>Hard-core lattice gas refers to a model used in statistical physics to study the behavior of particles on a lattice, where the particles are subject to an exclusion principle known as the &quot;hard-core&quot; interaction that characterized by a blockade radius. Distances between two particles can not be smaller than this radius.</p><ul><li>Nath T, Rajesh R. Multiple phase transitions in extended hard-core lattice gas models in two dimensions[J]. Physical Review E, 2014, 90(1): 012120.</li><li>Fernandes H C M, Arenzon J J, Levin Y. Monte Carlo simulations of two-dimensional hard core lattice gases[J]. The Journal of chemical physics, 2007, 126(11).</li></ul><p>Let define a <span>$10 \times 10$</span> triangular lattice, with unit vectors</p><p class="math-container">\[\begin{align*}
\vec a &amp;= \left(\begin{matrix}1 \\ 0\end{matrix}\right)\\
\vec b &amp;= \left(\begin{matrix}\frac{1}{2} \\ \frac{\sqrt{3}}{2}\end{matrix}\right)
\end{align*}\]</p><pre><code class="language-julia hljs">a, b = (1, 0), (0.5, 0.5*sqrt(3))
Na, Nb = 10, 10
sites = [a .* i .+ b .* j for i=1:Na, j=1:Nb]</code></pre><pre><code class="nohighlight hljs">10×10 Matrix{Tuple{Float64, Float64}}:
 (1.5, 0.866025)   (2.0, 1.73205)   (2.5, 2.59808)   (3.0, 3.4641)   (3.5, 4.33013)   (4.0, 5.19615)   (4.5, 6.06218)   (5.0, 6.9282)   (5.5, 7.79423)   (6.0, 8.66025)
 (2.5, 0.866025)   (3.0, 1.73205)   (3.5, 2.59808)   (4.0, 3.4641)   (4.5, 4.33013)   (5.0, 5.19615)   (5.5, 6.06218)   (6.0, 6.9282)   (6.5, 7.79423)   (7.0, 8.66025)
 (3.5, 0.866025)   (4.0, 1.73205)   (4.5, 2.59808)   (5.0, 3.4641)   (5.5, 4.33013)   (6.0, 5.19615)   (6.5, 6.06218)   (7.0, 6.9282)   (7.5, 7.79423)   (8.0, 8.66025)
 (4.5, 0.866025)   (5.0, 1.73205)   (5.5, 2.59808)   (6.0, 3.4641)   (6.5, 4.33013)   (7.0, 5.19615)   (7.5, 6.06218)   (8.0, 6.9282)   (8.5, 7.79423)   (9.0, 8.66025)
 (5.5, 0.866025)   (6.0, 1.73205)   (6.5, 2.59808)   (7.0, 3.4641)   (7.5, 4.33013)   (8.0, 5.19615)   (8.5, 6.06218)   (9.0, 6.9282)   (9.5, 7.79423)   (10.0, 8.66025)
 (6.5, 0.866025)   (7.0, 1.73205)   (7.5, 2.59808)   (8.0, 3.4641)   (8.5, 4.33013)   (9.0, 5.19615)   (9.5, 6.06218)   (10.0, 6.9282)  (10.5, 7.79423)  (11.0, 8.66025)
 (7.5, 0.866025)   (8.0, 1.73205)   (8.5, 2.59808)   (9.0, 3.4641)   (9.5, 4.33013)   (10.0, 5.19615)  (10.5, 6.06218)  (11.0, 6.9282)  (11.5, 7.79423)  (12.0, 8.66025)
 (8.5, 0.866025)   (9.0, 1.73205)   (9.5, 2.59808)   (10.0, 3.4641)  (10.5, 4.33013)  (11.0, 5.19615)  (11.5, 6.06218)  (12.0, 6.9282)  (12.5, 7.79423)  (13.0, 8.66025)
 (9.5, 0.866025)   (10.0, 1.73205)  (10.5, 2.59808)  (11.0, 3.4641)  (11.5, 4.33013)  (12.0, 5.19615)  (12.5, 6.06218)  (13.0, 6.9282)  (13.5, 7.79423)  (14.0, 8.66025)
 (10.5, 0.866025)  (11.0, 1.73205)  (11.5, 2.59808)  (12.0, 3.4641)  (12.5, 4.33013)  (13.0, 5.19615)  (13.5, 6.06218)  (14.0, 6.9282)  (14.5, 7.79423)  (15.0, 8.66025)</code></pre><p>There exists blockade interactions between hard-core particles. We connect two lattice sites within blockade radius by an edge. Two ends of an edge can not both be occupied by particles.</p><pre><code class="language-julia hljs">blockade_radius = 1.1
using GenericTensorNetworks: show_graph, unit_disk_graph
using GenericTensorNetworks.Graphs: edges, nv
graph = unit_disk_graph(vec(sites), blockade_radius)
show_graph(graph; locs=sites, texts=fill(&quot;&quot;, length(sites)))</code></pre><p><img src="../main-5.svg" alt/></p><p>These constraints defines an independent set problem that characterized by the following energy based model. Let <span>$G = (V, E)$</span> be a graph, where <span>$V$</span> is the set of vertices and <span>$E$</span> is the set of edges. The energy model for the hard-core lattice gas problem is</p><p class="math-container">\[E(\mathbf{n}) = -\sum_{i \in V}w_i n_i + U \sum_{(i, j) \in E} n_i n_j\]</p><p>where <span>$n_i \in \{0, 1\}$</span> is the number of particles at site <span>$i$</span>, and <span>$w_i$</span> is the weight associated with it. For unweighted graphs, the weights are uniform. <span>$U$</span> is the repulsive interaction strength between two particles. To represent the independence constraint, we let <span>$U = \infty$</span>, i.e. coexitence of two particles at two sites connected by an edge is completely forbidden. The solution space hard-core lattice gas is equivalent to that of an independent set problem. The independent set problem involves finding a set of vertices in a graph such that no two vertices in the set are adjacent (i.e., there is no edge connecting them). One can create a tensor network based modeling of an independent set problem with package <a href="https://github.com/QuEraComputing/GenericTensorNetworks.jl"><code>GenericTensorNetworks.jl</code></a>.</p><pre><code class="language-julia hljs">using GenericTensorNetworks
problem = IndependentSet(graph; optimizer=GreedyMethod());</code></pre><p>There are plenty of discussions related to solution space properties in the <code>GenericTensorNetworks</code> <a href="https://queracomputing.github.io/GenericTensorNetworks.jl/dev/generated/IndependentSet/">documentaion page</a>. In this example, we show how to use <code>TensorInference</code> to use probabilistic inference for understand the finite temperature properties of this statistical model. We use <a href="../../../api/public/#TensorInference.TensorNetworkModel"><code>TensorNetworkModel</code></a> to convert a combinatorial optimization problem to a probabilistic model. Here, we let the inverse temperature be <span>$\beta = 3$</span>.</p><h2 id="Probabilistic-modeling-correlation-functions"><a class="docs-heading-anchor" href="#Probabilistic-modeling-correlation-functions">Probabilistic modeling correlation functions</a><a id="Probabilistic-modeling-correlation-functions-1"></a><a class="docs-heading-anchor-permalink" href="#Probabilistic-modeling-correlation-functions" title="Permalink"></a></h2><pre><code class="language-julia hljs">using TensorInference
β = 3.0
pmodel = TensorNetworkModel(problem, β)</code></pre><pre><code class="nohighlight hljs">TensorNetworkModel{Int64, OMEinsum.DynamicNestedEinsum{Int64}, Array{Float64}}
variables: 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100
contraction time = 2^17.749, space = 2^12.0, read-write = 2^15.762</code></pre><p>The partition function of this statistical model can be computed with the <a href="../../../api/public/#TensorInference.probability"><code>probability</code></a> function.</p><pre><code class="language-julia hljs">partition_func = probability(pmodel)</code></pre><pre><code class="nohighlight hljs">exp(107.42267890429403) * fill(1.0)</code></pre><p>The default return value is a log-rescaled tensor. Use indexing to get the real value.</p><pre><code class="language-julia hljs">partition_func[]</code></pre><pre><code class="nohighlight hljs">4.4985927541462117e46</code></pre><p>The marginal probabilities can be computed with the <a href="../../../api/public/#TensorInference.marginals"><code>marginals</code></a> function, which measures how likely a site is occupied.</p><pre><code class="language-julia hljs">mars = marginals(pmodel)
show_graph(graph; locs=sites, vertex_colors=[(b = mars[[i]][2]; (1-b, 1-b, 1-b)) for i in 1:nv(graph)], texts=fill(&quot;&quot;, nv(graph)))</code></pre><p><img src="../main-16.svg" alt/></p><p>The can see the sites at the corner is more likely to be occupied. To obtain two-site correlations, one can set the variables to query marginal probabilities manually.</p><pre><code class="language-julia hljs">pmodel2 = TensorNetworkModel(problem, β; mars=[[e.src, e.dst] for e in edges(graph)])
mars = marginals(pmodel2);</code></pre><p>We show the probability that both sites on an edge are not occupied</p><pre><code class="language-julia hljs">show_graph(graph; locs=sites, edge_colors=[(b = mars[[e.src, e.dst]][1, 1]; (1-b, 1-b, 1-b)) for e in edges(graph)], texts=fill(&quot;&quot;, nv(graph)),
    edge_line_widths=edge_colors=[8*mars[[e.src, e.dst]][1, 1] for e in edges(graph)])</code></pre><p><img src="../main-20.svg" alt/></p><h2 id="The-most-likely-configuration"><a class="docs-heading-anchor" href="#The-most-likely-configuration">The most likely configuration</a><a id="The-most-likely-configuration-1"></a><a class="docs-heading-anchor-permalink" href="#The-most-likely-configuration" title="Permalink"></a></h2><p>The MAP and MMAP can be used to get the most likely configuration given an evidence. The relavant function is <a href="../../../api/public/#TensorInference.most_probable_config"><code>most_probable_config</code></a>. If we fix the vertex configuration at one corner to be one, we get the most probably configuration as bellow.</p><pre><code class="language-julia hljs">pmodel3 = TensorNetworkModel(problem, β; evidence=Dict(1=&gt;1))
mars = marginals(pmodel3)
logp, config = most_probable_config(pmodel3)</code></pre><pre><code class="nohighlight hljs">(102.0, [1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1])</code></pre><p>The log probability is 102. Let us visualize the configuration.</p><pre><code class="language-julia hljs">show_graph(graph; locs=sites, vertex_colors=[(1-b, 1-b, 1-b) for b in config], texts=fill(&quot;&quot;, nv(graph)))</code></pre><p><img src="../main-24.svg" alt/></p><p>The number of particles is</p><pre><code class="language-julia hljs">sum(config)</code></pre><pre><code class="nohighlight hljs">34</code></pre><p>Otherwise, we will get a suboptimal configuration.</p><pre><code class="language-julia hljs">pmodel3 = TensorNetworkModel(problem, β; evidence=Dict(1=&gt;0))
logp2, config2 = most_probable_config(pmodel)</code></pre><pre><code class="nohighlight hljs">(102.0, [1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1])</code></pre><p>The log probability is 99, which is much smaller.</p><pre><code class="language-julia hljs">show_graph(graph; locs=sites, vertex_colors=[(1-b, 1-b, 1-b) for b in config2], texts=fill(&quot;&quot;, nv(graph)))</code></pre><p><img src="../main-30.svg" alt/></p><p>The number of particles is</p><pre><code class="language-julia hljs">sum(config2)

# Sampling configurations</code></pre><pre><code class="nohighlight hljs">34</code></pre><p>One can ue <a href="../../../api/public/#TensorInference.sample"><code>sample</code></a> to generate samples from hard-core lattice gas at finite temperature. The return value is a matrix, with the columns correspond to different samples.</p><pre><code class="language-julia hljs">configs = sample(pmodel3, 1000)
sizes = sum.(configs)
[count(==(i), sizes) for i=0:34]  # counting sizes</code></pre><pre><code class="nohighlight hljs">35-element Vector{Int64}:
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
   0
  15
  24
  59
 144
 196
 198
 174
 113
  64
  13
   0</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../asia-network/main/">« Asia Network</a><a class="docs-footer-nextpage" href="../../performance/">Performance tips »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Monday 11 September 2023 16:49">Monday 11 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
